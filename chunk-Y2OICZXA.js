import{E as de,I as ue,L as pe,O as S,P as me,m as N,o as oe,q as se,v as le,y as ce}from"./chunk-6CE4OGMH.js";import"./chunk-2FMNJBPE.js";import"./chunk-C6367OYD.js";import"./chunk-PBZTZD35.js";import"./chunk-F443BPJZ.js";import{Ke as ie,Le as ne,ab as V,gb as o,ka as B,lb as _,mb as ee,qa as X,qe as te,re as ae,te as re}from"./chunk-CLEJM6ID.js";import"./chunk-HRCGL7IO.js";import"./chunk-NPTIQR7O.js";import{A as R,Ab as j,Eb as H,G as I,Ha as b,Jb as s,Od as K,Og as J,P as O,Qa as y,Ub as Q,Vc as G,X as q,Y as M,a as k,b as D,bb as U,db as Z,fa as v,ia as m,ib as h,ja as f,jb as d,k as E,kb as u,lb as C,oa as L,pb as z,sb as P,ub as p,vc as W,x as A,yb as Y,zb as $}from"./chunk-R75NSKFU.js";function ge(n,e){if(n&1){let t=z();d(0,"fdp-table",2,0),P("columnsChange",function(r){m(t);let i=p();return f(i.columnChangeCallback(r))})("filterChange",function(r){m(t);let i=p();return f(i.filtersChangeCallback(r))})("sortChange",function(r){m(t);let i=p();return f(i.sortingChangeCallback(r))})("rowToggleOpenState",function(r){m(t);let i=p();return f(i.rowToggleCallback(r))})("pageChange",function(r){m(t);let i=p();return f(i.pageChangeCallback(r))})("tableScrolled",function(r){m(t);let i=p();return f(i.setTableOffset(r))})("rowsRearrange",function(r){m(t);let i=p();return f(i.onRowsRearrange(r))})("cellFocused",function(r){m(t);let i=p();return f(i.onCellFocused(r))}),C(2,"fdp-table-toolbar",3)(3,"fdp-column",4)(4,"fdp-column",5)(5,"fdp-column",6)(6,"fdp-column",7)(7,"fdp-column",8),u(),C(8,"fdp-table-p13-dialog",9)}if(n&2){let t=H(1),a=p();h("dataSource",a.source)("initialVisibleColumns",a.columns)("initialSortBy",a.sortBy)("initialFilterBy",a.initialFilterBy)("initialPage",a.page)("pageScrolling",!0)("pageSize",4)("loadPagesBefore",!0)("isTreeTable",!0),b(3),h("sortable",!0)("groupable",!0)("filterable",!0),b(),h("sortable",!0)("filterable",!0),b(),h("sortable",!0)("filterable",!0),b(2),h("sortable",!0)("filterable",!0),b(),h("table",t)}}var be=(()=>{let e=class e{constructor(){this.sortBy=[{field:"price.value",direction:N.ASC}],this.columns=["name","price","status"],this.items=[...T],this.source=new x(new w(this.items,v(V))),this.page=1,this.initialFilterBy=[],this.displayTable=!0,this.tableOffset=0,this.applyScroll=!1,this._dateTimeAdapter=v(V),this._cdr=v(W),this._destroyRef=v(L),this._refresh$=new E}toggleTable(){this.applyScroll=!this.displayTable,this.displayTable=!this.displayTable,this.items=[...T],this.source=new x(new w(this.items,this._dateTimeAdapter)),this._cdr.detectChanges(),this._listenOnTableData()}ngAfterViewInit(){this._listenOnTableData()}columnChangeCallback(a){console.log(a),this.columns=a.current}filtersChangeCallback(a){console.log(a),this.initialFilterBy=a.current}sortingChangeCallback(a){console.log(a),this.sortBy=a.current}onRowsRearrange(a){console.log(a)}rowToggleCallback(a){let r=T.findIndex(i=>i.id===a.row.id);r!==-1&&(T[r].expanded=a.expanded)}pageChangeCallback(a){console.log(a),this.page=a.current.currentPage}setTableOffset(a){this.tableOffset=a}onCellFocused(a){this.focusedCell=a}_listenOnTableData(){if(this._refresh$.next(),this._refresh$.complete(),this._refresh$=new E,!this.table)return;let a=I(K(this._destroyRef),this._refresh$);this.table._dataSourceDirective.onDataReceived.pipe(q(()=>this.table.tableRowsSet),M(a)).subscribe(()=>{this.applyScroll&&(this.applyScroll=!1,this.table.tableScrollable.setScrollTop(this.tableOffset,!1),this.focusedCell&&this.table.focusCell(this.focusedCell))})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=y({type:e,selectors:[["fdp-platform-table-preserved-state-example"]],viewQuery:function(r,i){if(r&1&&Y(S,5),r&2){let l;$(l=j())&&(i.table=l.first)}},features:[Q([ee()])],decls:5,vars:1,consts:[["table",""],["fd-button","",3,"click"],["bodyHeight","10rem","relationKey","children","expandedStateKey","expanded","dropMode","group",3,"columnsChange","filterChange","sortChange","rowToggleOpenState","pageChange","tableScrolled","rowsRearrange","cellFocused","dataSource","initialVisibleColumns","initialSortBy","initialFilterBy","initialPage","pageScrolling","pageSize","loadPagesBefore","isTreeTable"],["title","Order Items"],["name","name","key","name","label","Name",3,"sortable","groupable","filterable"],["name","description","key","description","label","Description",3,"sortable","filterable"],["name","price","key","price.value","label","Price",3,"sortable","filterable"],["name","verified","key","verified","label","Verified"],["name","status","key","status","label","Status",3,"sortable","filterable"],[3,"table"]],template:function(r,i){r&1&&(d(0,"p"),s(1,"Toggle button destroys the table completely if it exists, and restores it's state when newly created."),u(),d(2,"button",1),P("click",function(){return i.toggleTable()}),s(3,"Toggle table"),u(),U(4,ge,9,19)),r&2&&(b(4),Z(i.displayTable?4:-1))},dependencies:[J,me,S,de,pe,ue,ce,le,_],encapsulation:2,changeDetection:0});let n=e;return n})(),x=class extends se{constructor(e){super(e)}},w=class extends oe{constructor(e,t){super(),this.dateTimeAdapter=t,this.items=e,this.totalItems=this.items.length}fetchData(e){return this.fetch(e).pipe(R(t=>(this.searchInput&&(t=this.search(t,D(k({},e),{searchInput:this.searchInput}))),e?.filterBy&&(t=this.filter(t,e)),e?.sortBy&&(t=this.sort(e,t)),he(t).slice((e.page.currentPage-1)*e.page.pageSize,e.page.currentPage*e.page.pageSize))),O(1e3))}fetch(e){let t=this.items;return A(t)}sort({sortBy:e},t){return t=t.slice(),e=e.filter(({field:a})=>!!a),e.length===0?t:t.sort((a,r)=>e.map(({field:i,direction:l})=>{let c=l===N.ASC?1:-1;return Se(a,r,i)*c}).find((i,l,c)=>i!==0||l===c.length-1)??0)}filter(e,{filterBy:t}){return t.filter(({field:a})=>!!a).forEach(a=>{e=e.filter(r=>{switch(a.field){case"name":case"description":return F(r,a);case"price.value":return this.filterByPrice(r,a);case"status":return this.filterByStatus(r,a);case"statusColor":return this.filterByStatusColor(r,a);case"verified":return _e(r,a);case"date":return ye(r,a,this.dateTimeAdapter);default:return!1}})}),e}filterByPrice(e,t){let a=t.value;if(a&&typeof a=="object"&&("min"in a||"max"in a)){let r=t.value,i=e.price.value,l=Number.parseFloat(r?.min),c=Number.parseFloat(r?.max);return(Number.isNaN(l)||i>=l)&&(Number.isNaN(c)||i<=c)}return Ce(e,t)}filterByStatus(e,t){return Array.isArray(t.value)?fe(e,t):F(e,t)}filterByStatusColor(e,t){return Array.isArray(t.value)?fe(e,t):F(e,t)}},F=(n,e)=>{let t=e.value&&e.value.toLocaleLowerCase(),a=e.value2&&e.value2.toLocaleLowerCase()||"",r=g(e.field,n).toLocaleLowerCase(),i=!1;switch(e.strategy){case"equalTo":i=r===t;break;case"greaterThan":i=r>t;break;case"greaterThanOrEqualTo":i=r>=t;break;case"lessThan":i=r<t;break;case"lessThanOrEqualTo":i=r<=t;break;case"between":i=r>=t&&r<=a;break;case"beginsWith":i=r.startsWith(t);break;case"endsWith":i=r.endsWith(t);break;case"contains":default:i=r.includes(t)}return e.exclude?!i:i},Ce=(n,e)=>{let t=Number.parseFloat(e.value),a=Number.parseFloat(e.value2)||0,r=Number.parseFloat(g(e.field,n)),i=!1;switch(e.strategy){case"greaterThan":i=r>t;break;case"greaterThanOrEqualTo":i=r>=t;break;case"lessThan":i=r<t;break;case"lessThanOrEqualTo":i=r<=t;break;case"between":i=r>=t&&r<=a;break;case"equalTo":default:i=r===t}return e.exclude?!i:i},ye=(n,e,t)=>{let a=e.value,r=e.value2,i=g(e.field,n),l=t.compareDate(i,a),c=!1;switch(e.strategy){case"after":c=l>0;break;case"onOrAfter":c=l>=0;break;case"before":c=l<0;break;case"beforeOrOn":c=l<=0;break;case"between":c=t.isBetween(i,a,r);break;case"equalTo":default:c=t.dateTimesEqual(i,a)}return e.exclude?!c:c},_e=(n,e)=>{let t=e.value,a=g(e.field,n),r=!1;switch(e.strategy){case"equalTo":default:r=a===t}return e.exclude?!r:r},fe=(n,e)=>{let t=e.value,a=g(e.field,n),r=!1;switch(e.strategy){case"equalTo":default:r=t.includes(a)}return!t.length||e.exclude?!r:r},Se=(n,e,t)=>(t&&(n=g(t,n),e=g(t,e)),n>e?1:n===e?0:-1);function g(n,e){return n.split(".").reduce((t,a)=>t?t[a]:null,e)}function he(n,e){return n.filter(t=>t.parentId===e).map(t=>D(k({},t),{children:he(n,t.id)}))}var T=[{id:1,name:"10 Portable DVD player",description:"diam neque vestibulum eget vulputate",price:{value:66.04,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,7),verified:!0,expanded:!1},{id:2,name:"Astro Laptop 1516",description:"pede malesuada",price:{value:489.01,currency:"EUR"},status:"Out of stock",statusColor:"negative",date:new o(2020,2,5),verified:!0,parentId:1},{id:3,name:"Benda Laptop 1408",description:"suspendisse potenti cras in",price:{value:243.49,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,9,22),verified:!0,parentId:1},{id:4,name:"Astro Laptop 1516",description:"pede malesuada",price:{value:489.01,currency:"EUR"},status:"Out of stock",statusColor:"negative",date:new o(2020,2,5),verified:!0,expanded:!0,children:[]},{id:5,name:"10 Portable DVD player",description:"diam neque vestibulum eget vulputate",price:{value:66.04,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,7),verified:!0,expanded:!0,parentId:4},{id:6,name:"Astro Phone 6",description:"penatibus et magnis",price:{value:154.1,currency:"IDR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,12),verified:!0,parentId:5},{id:7,name:"Beam Breaker B-1",description:"fermentum donec ut",price:{value:36.56,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,11,24),verified:!1,parentId:5},{id:8,name:"Beam Breaker B-2",description:"sapien in sapien iaculis congue",price:{value:332.57,currency:"NZD"},status:"No info",date:new o(2020,10,23),verified:!0,parentId:5},{id:9,name:"Astro Phone 6",description:"penatibus et magnis",price:{value:154.1,currency:"IDR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,12),verified:!0},{id:10,name:"Beam Breaker B-1",description:"fermentum donec ut",price:{value:36.56,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,11,24),verified:!1},{id:11,name:"Beam Breaker B-2",description:"sapien in sapien iaculis congue",price:{value:332.57,currency:"NZD"},status:"No info",date:new o(2020,10,23),verified:!0},{id:12,name:"Benda Laptop 1408",description:"suspendisse potenti cras in",price:{value:243.49,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,9,22),verified:!0},{id:13,name:"Bending Screen 21HD",description:"nunc nisl duis bibendum",price:{value:66.46,currency:"EUR"},status:"Available",statusColor:"positive",date:new o(2020,8,14),verified:!1},{id:14,name:"Blaster Extreme",description:"quisque ut",price:{value:436.88,currency:"USD"},status:"Available",statusColor:"positive",date:new o(2020,8,15),verified:!0},{id:15,name:"Broad Screen 22HD",description:"ultrices posuere",price:{value:458.18,currency:"CNY"},status:"Available",statusColor:"positive",date:new o(2020,5,4),verified:!0},{id:16,name:"Camcorder View",description:"integer ac leo pellentesque",price:{value:300.52,currency:"USD"},status:"Available",statusColor:"positive",date:new o(2020,5,5),verified:!0},{id:17,name:"Cepat Tablet 10.5",description:"rutrum rutrum neque aenean auctor",price:{value:365.12,currency:"NZD"},status:"No info",date:new o(2020,5,6),verified:!0},{id:18,name:"Ergo Mousepad",description:"tortor duis mattis egestas",price:{value:354.46,currency:"EUR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,5,7),verified:!0},{id:19,name:"Ergo Screen E-I",description:"massa quis augue luctus tincidunt",price:{value:387.23,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,3,23),verified:!0},{id:20,name:"Ergo Screen E-II",description:"orci eget",price:{value:75.86,currency:"EUR"},status:"No info",date:new o(2020,3,20),verified:!1},{id:21,name:"Gaming Monster",description:"cubilia curae",price:{value:152.95,currency:"EGP"},status:"No info",date:new o(2020,9,20),verified:!1},{id:22,name:"Gaming Monster Pro",description:"pharetra magna vestibulum aliquet",price:{value:213.47,currency:"MZN"},status:"Out of stock",statusColor:"negative",date:new o(2020,4,17),verified:!1}];var Te="preserved-state/platform-table-preserved-state-example.component.html",xe="preserved-state/platform-table-preserved-state-example.component.ts",at=(()=>{let e=class e{constructor(){this.childService=v(ie),this.route=v(G),this.preservedStateFiles=[{language:"html",code:B(Te),fileName:"platform-table-preserved-state-example",name:"platform-table-preserved-state-example"},{language:"typescript",code:B(xe),fileName:"platform-table-preserved-state-example",component:"PlatformTablePreservedStateExampleComponent",name:"platform-table-preserved-state-example"}],this.childService.setLink(this.route.snapshot.routeConfig?.path)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=y({type:e,selectors:[["fdp-doc-preserved-state-docs"]],decls:26,vars:1,consts:[["id","preserved-state","componentName","table/preserved-state"],[3,"exampleFiles"]],template:function(r,i){r&1&&(d(0,"fd-docs-section-title",0),s(1," Preserving table state"),u(),d(2,"description")(3,"p"),s(4," In some cases, application should preserve the state of the table (current page, filters, grouping, sorting, etc) while navigating over pages. "),u(),d(5,"p"),s(6," To do so, developers can take advantage of using "),d(7,"code"),s(8,"initial[Property]"),u(),s(9," input properties and "),d(10,"code"),s(11,"[property]Change"),u(),s(12," output events. "),u(),d(13,"p"),s(14," Developers may also find the "),d(15,"code"),s(16,"(tableScrolled)"),u(),s(17," event useful to track the current position of the user's scroll status of the table. "),u(),d(18,"p"),s(19," The example below demonstrates how to pass initial state and store changed state locally, then recreate the table component and pass updated state to it. "),u(),d(20,"p"),s(21," The logic behind it is to keep loaded data source items in memory, manipulate their properties when some event from table emits, and reuse this data on new table initialization. "),u()(),d(22,"component-example"),C(23,"fdp-platform-table-preserved-state-example"),u(),C(24,"code-example",1)(25,"separator")),r&2&&(b(24),h("exampleFiles",i.preservedStateFiles))},dependencies:[re,ae,te,be,X,ne,_],encapsulation:2,changeDetection:0});let n=e;return n})();export{at as PreservedStateDocsComponent};
