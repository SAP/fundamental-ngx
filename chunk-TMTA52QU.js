import{Ac as $,Bc as Ot,Cc as Ft,Lb as wt,Ob as It,Rb as z,Sb as kt,ob as yt,qb as Tt,rb as vt,zc as Mt}from"./chunk-TAFSRIM4.js";import{v as Ct}from"./chunk-FF6RGUNA.js";import{V as tt,ha as rt,ka as gt,la as bt,ya as xt}from"./chunk-YMOCEM3U.js";import{$ as ue,$b as L,$g as Qe,A as pe,Aa as B,Ad as te,Ba as I,Be as De,Cb as _,Cg as Pe,Dg as Ne,Dh as it,Eb as r,Fa as X,Fb as be,Fd as w,Ff as Ae,Fh as nt,Gb as xe,Gc as N,Hc as Me,Hh as ot,If as Be,Ih as lt,Ka as p,La as C,Lb as y,Lh as ie,Ma as Y,Mb as T,Md as Oe,Nb as v,Nd as Fe,Nh as st,Og as ze,P as ce,Ph as at,Qg as $e,R as de,Rb as k,Sb as V,Sd as Se,Tb as R,Tg as je,Ua as he,Ub as ye,Uh as pt,V as G,Vh as ct,Xh as dt,Yh as ut,Zg as We,_b as Te,_g as Ke,_h as mt,a as le,ab as fe,ac as H,b as re,bc as M,bh as Ue,bi as _t,ca as me,cg as Re,db as m,dh as qe,eb as S,eg as Le,fh as Ge,g as Q,gb as d,h as se,hb as Ce,hh as Xe,ib as ge,ie as Ve,ja as D,jc as O,kc as P,kg as He,kh as Ye,l as U,lc as ve,le as Ee,mc as we,ob as g,oi as ht,pa as _e,pc as F,ph as Je,pi as ft,qa as s,r as ae,ra as a,rb as J,s as E,sb as Z,sc as Ie,sh as Ze,tb as c,tc as ke,ub as u,uh as et,vb as ee,wa as A,z as q,zb as f}from"./chunk-FQFR4TK3.js";var j=new me("MultiInputComponent");var Bt=["dialogTemplate"],Rt=()=>({displayAddonButton:!1});function Lt(o,e){if(o&1&&(c(0,"h1",3),V(1),u()),o&2){let t=r(2);p(),R(t.mobileConfig.title)}}function Ht(o,e){if(o&1){let t=f();c(0,"button",9),_("click",function(){s(t);let i=r(2);return a(i.handleDismiss())}),u()}o&2&&d("mobile",!0)}function Pt(o,e){}function Nt(o,e){if(o&1){let t=f();c(0,"div",10)(1,"fd-bar-element",11),m(2,Pt,0,0,"ng-template",12),u(),c(3,"fd-bar-element",13)(4,"button",14),_("click",function(){s(t);let i=r(2);return a(i.selectAll(i.allItemsSelected))}),u()()()}if(o&2){let t=r(2);p(2),d("ngTemplateOutlet",(t.childContent==null?null:t.childContent.controlTemplate)||null)("ngTemplateOutletContext",H(3,Rt)),p(2),d("fdType",t.allItemsSelected?"emphasized":"transparent")}}function zt(o,e){}function $t(o,e){if(o&1){let t=f();c(0,"fd-button-bar",15),_("click",function(){s(t);let i=r(2);return a(i.handleApprove())}),u()}if(o&2){let t=r(2);d("label",t.mobileConfig.approveButtonText)}}function jt(o,e){if(o&1){let t=f();c(0,"fd-button-bar",16),_("click",function(){s(t);let i=r(2);return a(i.handleDismiss())}),u()}if(o&2){let t=r(2);d("label",t.mobileConfig.cancelButtonText)}}function Wt(o,e){if(o&1&&(c(0,"fd-dialog",2)(1,"fd-dialog-header"),m(2,Lt,2,1,"h1",3)(3,Ht,1,1,"button",4)(4,Nt,5,4,"ng-template",5),u(),c(5,"fd-dialog-body"),m(6,zt,0,0,"ng-template",6),u(),c(7,"fd-dialog-footer"),m(8,$t,1,1,"fd-button-bar",7)(9,jt,1,1,"fd-button-bar",8),u()()),o&2){let t=e.$implicit,n=e.dialogConfig,i=r();d("dialogConfig",n)("dialogRef",t),p(2),g(i.mobileConfig.title?2:-1),p(),g(i.mobileConfig.hasCloseButton?3:-1),p(3),d("ngTemplateOutlet",(i.childContent==null?null:i.childContent.listTemplate)||null),p(2),g(i.mobileConfig.approveButtonText?8:-1),p(),g(i.mobileConfig.cancelButtonText?9:-1)}}var ne=(()=>{class o extends lt{constructor(t){super(t,ot.MULTI_INPUT),this.childContent=null}ngOnInit(){this._listenOnMultiInputOpenChange()}selectAll(t){this._component.selectAllItems(!t)}handleDismiss(){this.dialogRef.dismiss(),this._component.dialogDismiss(this._selectedBackup)}handleApprove(){this.dialogRef.close(),this._component.dialogApprove()}_toggleDialog(t){t&&(this._selectedBackup=this._component.selected?.length?[...this._component.selected]:[],this._dialogService.hasOpenDialogs()||this._open())}_listenOnMultiInputOpenChange(){this._component.openChange.pipe(te(this._destroyRef)).subscribe(t=>this._toggleDialog(t)),this._component.allItemsSelectedChange.pipe(te(this._destroyRef)).subscribe(t=>this.allItemsSelected=t)}_open(){this.dialogRef=this._dialogService.open(this.dialogTemplate,re(le({mobile:!0,disablePaddings:!0},this.dialogConfig),{backdropClickCloseable:!1,escKeyCloseable:!1,container:this._elementRef.nativeElement}))}static{this.\u0275fac=function(n){return new(n||o)(C(j))}}static{this.\u0275cmp=D({type:o,selectors:[["fd-multi-input-mobile"]],viewQuery:function(n,i){if(n&1&&y(Bt,5),n&2){let l;T(l=v())&&(i.dialogTemplate=l.first)}},standalone:!0,features:[fe,L],decls:2,vars:0,consts:[["dialogTemplate",""],[3,"fdDialogTemplate"],[3,"dialogConfig","dialogRef"],["fd-title",""],["fd-dialog-close-button","",3,"mobile"],["fdkTemplate","subheader"],[3,"ngTemplateOutlet"],["fdType","emphasized",3,"label"],[3,"label"],["fd-dialog-close-button","",3,"click","mobile"],["fd-bar-middle",""],[1,"custom-multi-input-mobile-control-element"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"custom-multi-input-select-all-bar-element"],["fd-button","","glyph","multiselect-all",3,"click","fdType"],["fdType","emphasized",3,"click","label"],[3,"click","label"]],template:function(n,i){n&1&&m(0,Wt,10,7,"ng-template",1,0,F)},dependencies:[et,Je,ze,Ge,Ye,je,Ze,Ae,Ue,Qe,Ke,Xe,qe,N,We],styles:[`.custom-multi-input-select-all-bar-element{min-width:2.25rem}.custom-multi-input-mobile-control-element{width:calc(100% - 2.25rem)}.custom-multi-input-mobile-control-element .fd-multi-input-input-group-custom{width:100%}
`],encapsulation:2,changeDetection:0})}}return o})();var W=class{constructor(){this._selected=new Map,this.selectionChanged=new I}get selected(){return[...this._selected.values()]}isSelected(e){return this._selected.has(e)}select(e,t){t?this._selected.set(e,t):e.forEach(([n,i])=>this._selected.set(n,i)),this.selectionChanged.emit([...this._selected])}deselect(e){this._selected.delete(e),this.selectionChanged.emit([...this._selected])}clear(){this._selected.clear(),this.selectionChanged.emit([...this._selected])}};var Ut=["control"],qt=["list"],Gt=["searchInputElement"],Xt=["*"];function Et(o,e){return this.valueFn(e.item)}var Dt=o=>({displayAddonButton:o}),Yt=()=>[],Jt=o=>({length:o}),Zt=o=>({option:o}),ei=o=>({$implicit:o});function ti(o,e){}function ii(o,e){if(o&1&&m(0,ti,0,0,"ng-template",7),o&2){r();let t=k(5),n=r();d("ngTemplateOutlet",t)("ngTemplateOutletContext",M(2,Dt,n.displayAddonButton))}}function ni(o,e){}function oi(o,e){}function li(o,e){if(o&1){let t=f();c(0,"fd-popover",9),_("isOpenChange",function(i){s(t);let l=r(2);return a(l.openChangeHandle(i))})("input",function(){s(t);let i=r(2);return a(!i.open&&i.openChangeHandle(!0))}),c(1,"fd-popover-control")(2,"form",10),_("submit",function(){s(t);let i=r(2);return a(i._onSubmit())}),m(3,ni,0,0,"ng-template",7),u()(),c(4,"fd-popover-body"),m(5,oi,0,0,"ng-template",11),xe(6),u()()}if(o&2){let t=r(),n=k(5),i=k(7),l=r();d("isOpen",l.open)("triggers",H(11,Yt))("maxWidth",l._popoverMaxWidth)("disabled",l.disabled)("fillControlMode",l.fillControlMode),p(3),d("ngTemplateOutlet",n)("ngTemplateOutletContext",M(12,Dt,l.displayAddonButton)),p(),ge("fd-popover__body--hidden",!t.displayedOptions.length),S("aria-hidden",!l.open),p(),d("ngTemplateOutlet",i)}}function ri(o,e){if(o&1){let t=f();c(0,"fd-token",17),_("onCloseClick",function(i){let l=s(t).$implicit,h=r(3);return a(h._onTokenCloseClick(l,!1,i))})("onRemove",function(){let i=s(t).$implicit,l=r(3);return a(l._onTokenCloseClick(i,!1))})("onTokenClick",function(i){s(t);let l=r(3);return a(l._tokenElementClicked(i))}),ee(1,"span",18),u()}if(o&2){let t=e.$implicit,n=r(3);d("disabled",n.disabled)("title",t.label),p(),d("innerHtml",t.label,X)}}function si(o,e){if(o&1){let t=f();c(0,"fd-input-group",12),_("addOnButtonClicked",function(i){s(t);let l=r(2);return a(l._addOnButtonClicked(i))}),c(1,"span",13),V(2),O(3,"fdTranslate"),u(),c(4,"fd-tokenizer",14,3),_("moreClickedEvent",function(){s(t);let i=r(2);return a(i._moreClicked())}),J(6,ri,2,3,"fd-token",15,Et,!0),c(8,"input",16,4),O(10,"fdTranslate"),_("onComplete",function(i){s(t);let l=r(2);return a(l._handleComplete(i))})("keydown",function(i){s(t);let l=r(2);return a(l._handleInputKeydown(i))})("focus",function(){s(t);let i=k(5);return a(i._showAllTokens())})("blur",function(){s(t);let i=k(5);return a(i._hideTokens())}),u()()()}if(o&2){let t=e.displayAddonButton,n=r(),i=r();d("state",i.state)("buttonFocusable",i.buttonFocusable)("button",t)("disabled",i.disabled)("isExpanded",i.open&&!i.mobile&&n.displayedOptions.length>0)("isControl",!0)("glyph",t?i.glyph:"")("glyphFont",i.glyphFont)("glyphAriaLabel",i.addOnButtonAriaLabel)("iconTitle",i.addonIconTitle),p(),S("id",i.tokenHiddenId),p(),R(ve(3,30,"coreMultiInput.tokensCountText",M(35,Jt,i.selected.length))),p(2),d("compactCollapse",i.compactCollapse)("showOverflowPopover",!1)("open",i.open)("tokenizerFocusable",!1)("multiAnnouncerOptions",i.filterFn(i.dropdownValues,i.searchTerm)),p(2),Z(n.selectedOptions),p(2),d("displayFn",i.displayFn)("matcher",i.typeAheadMatcher)("inputText",i._searchTermCtrl.value||"")("options",i.dropdownValues)("enable",!i.includes&&i.autoComplete&&!i.mobile)("formControl",i._searchTermCtrl)("ariaLabel",i.ariaLabel||P(10,33,"coreMultiInput.multiInputAriaLabel"))("ariaLabelledBy",i.ariaLabelledBy),S("placeholder",n.selectedOptions.length?null:i.placeholder)("aria-required",i.required)("aria-describedby",i.tokenHiddenId)("id",i.inputId)("title",i.title)}}function ai(o,e){}function pi(o,e){if(o&1){let t=f();c(0,"li",23),_("click",function(i){let l=s(t),h=l.$implicit,b=l.$index,x=r(4);return a(x._onCheckboxClick(h,i,b,!0))})("keyup",function(i){let l=s(t),h=l.$implicit,b=l.$index,x=r(4);return a(x._onCheckboxKeyup(h,i,b,!0))}),c(1,"fd-checkbox",24),_("click",function(i){let l=s(t),h=l.$implicit,b=l.$index,x=r(4);return a(x._onCheckboxClick(h,i,b))}),u(),m(2,ai,0,0,"ng-template",7),u()}if(o&2){let t=e.$implicit;r(3);let n=k(9);d("selected",!!t.isSelected),S("aria-label",t.label),p(),d("value",t.isSelected),p(),d("ngTemplateOutlet",n)("ngTemplateOutletContext",M(5,Zt,t))}}function ci(o,e){if(o&1){let t=f();c(0,"li",25),_("keyDown",function(i){s(t);let l=r(4);return a(l._showAllKeyDown(i))})("click",function(i){s(t);let l=r(4);return a(l._showAllClicked(i))}),c(1,"a",26),V(2),u()()}if(o&2){let t=r(4);p(2),ye("Show All (",t.dropdownValues.length,")")}}function di(o,e){if(o&1){let t=f();c(0,"ul",20),_("focusEscapeList",function(i){s(t);let l=r(3);return a(l.handleListFocusEscape(i))})("keydown.tab",function(){s(t);let i=r(3);return a(i._close())}),J(1,pi,3,7,"li",21,Et,!0),m(3,ci,3,1,"li",22),O(4,"async"),u()}if(o&2){let t=r(2),n=r();Ce("max-height",n.mobile?"auto":n.maxHeight)("min-width","100%"),d("selection",!0)("mobileMode",n.mobile)("byline",n.byline),p(),Z(t.displayedOptions),p(2),g(n.showAllButton&&P(4,8,n._onlySelected$)!==!0&&t.displayedOptions.length<n.dropdownValues.length?3:-1)}}function ui(o,e){if(o&1&&m(0,di,5,10,"ul",19),o&2){let t=r();g(t.displayedOptions.length?0:-1)}}function mi(o,e){if(o&1&&(ee(0,"span",27),O(1,"highlight")),o&2){let t=r().option,n=r(2);d("innerHtml",we(1,1,t.label,n._searchTermCtrl.value||"",n.highlight),X)}}function _i(o,e){}function hi(o,e){if(o&1&&m(0,_i,0,0,"ng-template",7),o&2){let t=r().option,n=r(2);d("ngTemplateOutlet",n.itemTemplate)("ngTemplateOutletContext",M(2,ei,t.item))}}function fi(o,e){if(o&1&&m(0,mi,2,5,"span",27)(1,hi,1,4,null,7),o&2){let t=r(2);g(t.itemTemplate?1:0)}}function Ci(o,e){if(o&1&&(c(0,"div",5)(1,"div",6),m(2,ii,1,4,null,7)(3,li,7,14,"fd-popover",8),u()(),m(4,si,11,37,"ng-template",null,0,F)(6,ui,1,1,"ng-template",null,1,F)(8,fi,2,1,"ng-template",null,2,F)),o&2){let t=r();p(2),g(t.mobile?2:3)}}function Vt(o){return oe(o)&&"item"in o&&"id"in o}function oe(o){return typeof o=="object"&&o!==null&&"value"in o&&"label"in o}var gi=0,K=class o{set searchTerm(e){this._searchTermCtrl.setValue(e)}get searchTerm(){return this._searchTermCtrl.value??""}set selected(e){if(this._selectionModel.clear(),e){let t=[...e],n=[];t.forEach(i=>{let l=this._optionItems.find(h=>h.value===i);l||(l=this._getOptionItem(i)),n.push(l)}),this._selectionModel.select(n.map(i=>[i.id,i]))}}get selected(){return this._selectionModel.selected.map(e=>e.value)}get _popoverMaxWidth(){return this.bodyMaxWidth==="none"?null:typeof this.bodyMaxWidth=="number"?this.bodyMaxWidth:this.elementRef.nativeElement.getBoundingClientRect().width}get _optionItems(){return this.optionItems$.value}get typeAheadMatcher(){return this.includes?(e,t)=>e.includes(t):(e,t)=>e.startsWith(t)}constructor(e,t,n,i,l,h,b,x){this._contentDensityObserver=e,this.elementRef=t,this._changeDetRef=n,this._dynamicComponentService=i,this._injector=l,this._viewContainerRef=h,this._rtlService=b,this._focusTrapService=x,this.placeholder="",this.disabled=!1,this.required=!1,this.compactCollapse=!0,this.maxHeight="300px",this.glyph="value-help",this.glyphFont=$e,this.dropdownValues=[],this.openDropdownOnAddOnClicked=!0,this.inputId="",this.highlight=!0,this.filterFn=this._defaultFilter,this.valueFn=this._defaultValueFn,this.displayFn=this._defaultDisplay,this.newTokenParseFn=this._defaultParse,this.newTokenValidateFn=this._defaultTokenValidate,this.fillControlMode="at-least",this.buttonFocusable=!0,this.allowNewTokens=!1,this.mobile=!1,this.showAllButton=!0,this.bodyMaxWidth="none",this.mobileConfig={hasCloseButton:!0,approveButtonText:"Select"},this.includes=!1,this.byline=!1,this.autoComplete=!0,this.searchTermChange=new I,this.selectedChange=new I,this.open=!1,this.displayAddonButton=!0,this._tokenCountHiddenLabel=`fd-multi-input-token-count-id-${gi++}`,this.tokenHiddenId=this._tokenCountHiddenLabel,this.openChange=new I,this.addOnButtonClicked=new I,this.allItemsSelectedChange=new I,this.optionItems$=new U([]),this._onlySelected$=new U(!1),this._searchTermCtrl=new ut(""),this._selectionModel=new W,this._viewModel$=this._getViewModel(),this._subscriptions=new se,this._rangeSelector=new Ve,this.onChange=()=>{},this.onTouched=()=>{}}buildComponentCssClass(){if(this.glyph==="value-help"&&this._dir==="rtl"){let e=this.elementRef.nativeElement.querySelector(".sap-icon--value-help");e&&(e.style.transform="scaleX(-1)")}return["fd-multi-input","fd-multi-input-custom",this.class]}_focusOut(e){this.elementRef.nativeElement.contains(e.relatedTarget)||this.onTouched()}ngOnInit(){this.buildComponentCssClass(),this._subscriptions.add(this._rtlService?.rtl.subscribe(e=>{this._dir=e?"rtl":"ltr",this.buildComponentCssClass()})),this.inputId||(this.inputId=Oe()),this._subscriptions.add(this._searchTermCtrl.valueChanges.pipe(ce()).subscribe(e=>{this.searchTermChange.emit(e??""),this._rangeSelector.reset()})),this._subscriptions.add(this._getViewModel().pipe(q(e=>!e.displayedOptions.some(t=>!t.isSelected))).subscribe(e=>this.allItemsSelectedChange.emit(e)))}ngOnChanges(e){if(this.buildComponentCssClass(),e.dropdownValues||e.searchTerm||e.valueFn||e.displayFn){let t=(this.dropdownValues??[]).map(n=>this._getOptionItem(n));this.optionItems$.next(t),this._changeDetRef.markForCheck()}e.disabled&&(this.disabled?this._searchTermCtrl.disable():this._searchTermCtrl.enable())}ngAfterViewInit(){this.mobile&&this._setUpMobileMode()}ngOnDestroy(){this._subscriptions.unsubscribe()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,e?this.elementRef.nativeElement.style.pointerEvents="none":this.elementRef.nativeElement.style.pointerEvents="auto",this._changeDetRef.detectChanges()}writeValue(e){this.selected=e,this._changeDetRef.markForCheck()}handleListFocusEscape(e){e==="up"&&!this.mobile&&this.searchInputElement.nativeElement.focus()}openChangeHandle(e){this.disabled||(this.open!==e&&this.openChange.emit(e),this.open=e,this.mobile||this._popoverOpenHandle(e),this.open?(this.disableParentFocusTrap(),this.searchInputElement?.nativeElement.focus()):(this._resetSearchTerm(),this.enableParentFocusTrap(),this._onlySelected$.next(!1)),this.tokenizer.tokenizerInnerEl.nativeElement.scrollLeft=this.tokenizer.tokenizerInnerEl.nativeElement.scrollWidth,this._changeDetRef.detectChanges())}selectAllItems(e){e?this.selected=this._optionItems.map(t=>t.value):this.selected=[],this._propagateChange()}_onCheckboxKeyup(e,t,n,i=!1){w.isKeyCode(t,[32,13])&&this._onCheckboxClick(e,t,n,i)}_onCheckboxClick(e,t,n,i=!1){return Q(this,null,function*(){let l=!this._selectionModel.isSelected(e.id);this._rangeSelector.onRangeElementToggled(n,t);let h=this._viewModel$.pipe(de()).subscribe(b=>{this._rangeSelector.applyValueToEachInRange(x=>this._handleSelect(l,b.displayedOptions[x],!1)),this._changeDetRef.detectChanges()});this._subscriptions.add(h),i?(this.openChangeHandle(!1),this.searchInputElement?.nativeElement.focus()):t.stopPropagation()})}_onTokenCloseClick(e,t,n){n?.preventDefault(),this._handleSelect(!1,e,t,!0)}_tokenElementClicked(e){let t=e.currentTarget.querySelector(".fd-token__text");t&&t.offsetWidth<t.scrollWidth&&this.open===!1&&this.openChangeHandle(!0)}_handleSelect(e,t,n=!0,i=!1){let l=this._selectionModel.selected.length;t=this._getOptionItem(t),e?this._selectionModel.select(t.id,t):this._selectionModel.deselect(t.id),this._shouldPopoverBeUpdated(l,this._selectionModel.selected.length)&&this.popoverRef.refreshPosition(),n&&(this._resetSearchTerm(),this.searchInputElement.nativeElement.focus()),this._selectionModel.selected.length===0&&(this.searchInputElement.nativeElement.focus(),this._changeDetRef.detectChanges()),this._propagateChange(i)}_handleInputKeydown(e){w.isKeyCode(e,40)&&!this.mobile?(e.altKey&&this.openChangeHandle(!0),this.listComponent&&(this.listComponent.setItemActive(0),e.preventDefault())):w.isKeyCode(e,[40,38,13])?this.openChangeHandle(!0):w.isKeyCode(e,27)?this.openChangeHandle(!1):w.isKeyCode(e,9)&&this.open?this._close():(w.isKeyType(e,"alphabetical")||w.isKeyType(e,"numeric"))&&(this.open||(this.openChangeHandle(!0),this.searchInputElement.nativeElement.focus()))}_showAllClicked(e){e.preventDefault(),e.stopPropagation(),this._searchTermCtrl.setValue(""),this.searchInputElement.nativeElement.focus()}_showAllKeyDown(e){w.isKeyCode(e,[32,13])&&this._showAllClicked(e)}_onSubmit(){let e=this.searchTerm;if(e==="")return;if(!this._selectFirstFiltered(e)&&this.allowNewTokens&&this.newTokenValidateFn(this._searchTermCtrl.value??"")){let n=this.newTokenParseFn(this._searchTermCtrl.value??""),i=this._addNewTokenToDropDownValues(n);this._handleSelect(!0,i),this._searchTermCtrl.setValue(""),this.open=!1}}_handleComplete({term:e}){this.searchTerm=e}dialogDismiss(e){this.openChangeHandle(!1),this._resetSearchTerm(),this.selected=e}dialogApprove(){this._propagateChange(!0),this.openChangeHandle(!1),this._resetSearchTerm()}_moreClicked(){this._onlySelected$.next(!0),this.openChangeHandle(!0)}_addOnButtonClicked(e){this.addOnButtonClicked.emit(e),this.openDropdownOnAddOnClicked?this.openChangeHandle(!this.open):this.open&&this.openChangeHandle(!1)}disableParentFocusTrap(){this._focusTrapService?.pauseCurrentFocusTrap()}enableParentFocusTrap(){this._focusTrapService?.unpauseCurrentFocusTrap()}_close(){this.searchInputElement.nativeElement.focus(),this.openChangeHandle(!1)}_addNewTokenToDropDownValues(e){this.dropdownValues.push(e);let t=this._getOptionItem(e);return this.optionItems$.next([...this._optionItems,t]),t}_selectFirstFiltered(e){let t=this.filterFn(this.dropdownValues,e);if(Array.isArray(t)&&t.length>0&&this.autoComplete){let n=this._getOptionItem(t[0]);return this._handleSelect(!0,n),this._searchTermCtrl.setValue(""),this.open=!1,!0}return!1}_defaultFilter(e,t=""){let n=t.trim().toLocaleLowerCase();return e.filter(i=>{if(i){let h=(Vt(i)?i.label:this.displayFn(i))?.toLocaleLowerCase()||"";return this.typeAheadMatcher(h,n)}})}_defaultValueFn(e){return e}_defaultDisplay(e){if(typeof e=="string")return e;if(oe(e))return e.label}_defaultParse(e){return e}_defaultTokenValidate(e){return!!e}_popoverOpenHandle(e){this.open=e}_propagateChange(e){if(!this.mobile||e){let t=this._selectionModel.selected.map(n=>n.value);this.onChange(t),this.selectedChange.emit(t)}}_shouldPopoverBeUpdated(e,t){return!!this.popoverRef&&(e===0&&t===1||e===1&&t===0)}_setUpMobileMode(){return Q(this,null,function*(){let e=A.create({providers:[{provide:j,useValue:this}],parent:this._injector});this._dynamicComponentService.createDynamicComponent({listTemplate:this.listTemplate,controlTemplate:this.controlTemplate},ne,{containerRef:this._viewContainerRef},{injector:e})})}_getItemIdentifier(e){if(!this.optionItemIdentifier){let t=this.valueFn(e);return typeof t!="string"&&typeof t!="number"&&typeof t!="symbol"&&Ie()&&console.warn("optionItemIdentifier is not set and valueFn does not return a string, number or symbol",e),t}return typeof this.optionItemIdentifier=="function"?this.optionItemIdentifier(e):Se(e,this.optionItemIdentifier)}_resetSearchTerm(){this._searchTermCtrl.setValue(""),this._changeDetRef.detectChanges()}_getOptionItem(e){if(Vt(e))return e;let{label:t,value:n}=this._getValueAndLabelOfItem(e);return{id:this._getItemIdentifier(e),item:e,label:t,value:n,isSelected:!1}}_getValueAndLabelOfItem(e){let t=typeof e=="object"&&e!==null?e[Object.keys(e)[0]]:e,n=this.valueFn(e)??t,i=this.displayFn(e)??t;return oe(e)&&(this.valueFn===this._defaultValueFn&&(n=e.value),this.displayFn===this._defaultDisplay&&(i=e.label)),{label:i,value:n}}_getViewModel(){return pe([this._searchTermCtrl.valueChanges.pipe(G(this._searchTermCtrl.value)),this._selectionModel.selectionChanged.pipe(G(null)),this._onlySelected$,this.optionItems$]).pipe(q(()=>{let e=this._searchTermCtrl.value??"",t=this.filterFn(this.dropdownValues,e),n=this._onlySelected$.value,i=(Array.isArray(t)?t:[]).map(l=>this._getOptionItem(l));return i.forEach(l=>l.isSelected=this._selectionModel.isSelected(l.id)),n&&(i=i.filter(l=>l.isSelected)),{selectedOptions:this._selectionModel.selected,displayedOptions:i}}))}static{this.\u0275fac=function(t){return new(t||o)(C(Pe),C(B),C(ke),C(Le),C(A),C(he),C(De,8),C(Ee,8))}}static{this.\u0275cmp=D({type:o,selectors:[["fd-multi-input"]],viewQuery:function(t,n){if(t&1&&(y(ie,5),y(Ut,5,Y),y(qt,5,Y),y(z,5),y(Gt,5,B),y($,5)),t&2){let i;T(i=v())&&(n.popoverRef=i.first),T(i=v())&&(n.controlTemplate=i.first),T(i=v())&&(n.listTemplate=i.first),T(i=v())&&(n.listComponent=i.first),T(i=v())&&(n.searchInputElement=i.first),T(i=v())&&(n.tokenizer=i.first)}},hostBindings:function(t,n){t&1&&_("focusout",function(l){return n._focusOut(l)})},inputs:{placeholder:"placeholder",disabled:"disabled",required:"required",compactCollapse:"compactCollapse",maxHeight:"maxHeight",glyph:"glyph",glyphFont:"glyphFont",dropdownValues:"dropdownValues",openDropdownOnAddOnClicked:"openDropdownOnAddOnClicked",addonIconTitle:"addonIconTitle",searchTerm:"searchTerm",inputId:"inputId",highlight:"highlight",selected:"selected",class:"class",filterFn:"filterFn",valueFn:"valueFn",displayFn:"displayFn",newTokenParseFn:"newTokenParseFn",optionItemIdentifier:"optionItemIdentifier",newTokenValidateFn:"newTokenValidateFn",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",fillControlMode:"fillControlMode",state:"state",buttonFocusable:"buttonFocusable",allowNewTokens:"allowNewTokens",mobile:"mobile",showAllButton:"showAllButton",bodyMaxWidth:"bodyMaxWidth",mobileConfig:"mobileConfig",includes:"includes",itemTemplate:"itemTemplate",title:"title",byline:"byline",autoComplete:"autoComplete",open:"open",displayAddonButton:"displayAddonButton",addOnButtonAriaLabel:"addOnButtonAriaLabel",tokenHiddenId:"tokenHiddenId"},outputs:{searchTermChange:"searchTermChange",selectedChange:"selectedChange",openChange:"openChange",addOnButtonClicked:"addOnButtonClicked",allItemsSelectedChange:"allItemsSelectedChange"},standalone:!0,features:[Te([{provide:st,useExisting:ue(()=>o),multi:!0},Ct,gt(o),Ne()]),_e,L],ngContentSelectors:Xt,decls:2,vars:3,consts:[["control",""],["list",""],["itemSource",""],["tokenizer",""],["searchInputElement",""],[1,"fd-multi-input","fd-multi-input-custom"],[1,"fd-multi-input-field"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["additionalBodyClass","fd-popover-custom-list",1,"fd-multi-input-popover-custom",3,"isOpen","triggers","maxWidth","disabled","fillControlMode"],["additionalBodyClass","fd-popover-custom-list",1,"fd-multi-input-popover-custom",3,"isOpenChange","input","isOpen","triggers","maxWidth","disabled","fillControlMode"],[3,"submit"],[3,"ngTemplateOutlet"],[1,"fd-multi-input-input-group-custom",3,"addOnButtonClicked","state","buttonFocusable","button","disabled","isExpanded","isControl","glyph","glyphFont","glyphAriaLabel","iconTitle"],["aria-hidden","true",1,"fd-multi-input__invisible-text"],["tabindex","-1","fdMultiAnnouncer","",1,"fd-multi-input-tokenizer-custom",3,"moreClickedEvent","compactCollapse","showOverflowPopover","open","tokenizerFocusable","multiAnnouncerOptions"],[3,"disabled","title"],["type","text","autocomplete","off","fd-form-control","","fd-input-group-input","","fdkAutoComplete","",1,"fd-input","fd-tokenizer__input","fd-multi-input-tokenizer-input",3,"onComplete","keydown","focus","blur","displayFn","matcher","inputText","options","enable","formControl","ariaLabel","ariaLabelledBy"],[3,"onCloseClick","onRemove","onTokenClick","disabled","title"],[3,"innerHtml"],["fd-list","","aria-multiselectable","true",1,"fd-multi-input-menu-overflow",3,"selection","mobileMode","max-height","byline","min-width"],["fd-list","","aria-multiselectable","true",1,"fd-multi-input-menu-overflow",3,"focusEscapeList","keydown.tab","selection","mobileMode","byline"],["fd-list-item","",3,"selected"],["fd-list-item","",1,"fd-multi-input-show-all"],["fd-list-item","",3,"click","keyup","selected"],[3,"click","value"],["fd-list-item","",1,"fd-multi-input-show-all",3,"keyDown","click"],["fd-link","","role","button","tabindex","0"],["fd-list-title","","fdTruncatedTitle","",3,"innerHtml"]],template:function(t,n){if(t&1&&(be(),m(0,Ci,10,1),O(1,"async")),t&2){let i;g((i=P(1,1,n._viewModel$))?0:-1,i)}},dependencies:[N,ie,nt,ht,mt,at,pt,ct,dt,it,vt,Tt,yt,Ot,Mt,$,bt,Fe,ft,_t,kt,z,It,wt,xt,rt,Me,He,tt,Ft,Be],styles:[`.fd-multi-input-tokenizer-custom{width:calc(100% - 2.25rem)}[class*=--compact] .fd-multi-input-tokenizer-custom:not([class*=--cozy]):not([class*=--condensed]),.is-compact .fd-multi-input-tokenizer-custom:not(.is-cozy):not(.is-condensed),.fd-multi-input-tokenizer-custom[class*=--compact],.fd-multi-input-tokenizer-custom.is-compact{width:calc(100% - 2rem)}.fd-multi-input__invisible-text{display:none!important}.fd-multi-input-input-group-custom{max-width:100%}.fd-multi-input-custom{display:block}.fd-multi-input-item{cursor:pointer;padding:0}.fd-multi-input-popover-size{overflow:auto;display:block}.fd-multi-input-popover-custom.fd-popover-custom{max-width:100%;display:block}.fd-multi-input-show-all{width:100%;display:flex;justify-content:flex-end;background-color:transparent}.fd-multi-input-show-all .fd-link:active{color:inherit}.fd-multi-input-checkbox{width:100%;cursor:pointer}.fd-multi-input-checkbox .fd-checkbox__label{color:inherit}.fd-multi-input-menu-overflow{max-width:37.5rem}.fd-input.fd-multi-input-tokenizer-input{min-width:4rem;margin-top:0;margin-bottom:0;padding-left:0;background-color:transparent}.fd-list--multi-input{max-width:100%}.fd-popover__body--hidden{display:none}
`],encapsulation:2,changeDetection:0})}};ae([Re,E("design:type",Function),E("design:paramtypes",[]),E("design:returntype",Array)],K.prototype,"buildComponentCssClass",null);export{K as a};
