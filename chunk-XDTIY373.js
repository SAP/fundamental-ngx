var r=new WeakMap,i=class e{static get tasks(){return r}static enqueue(t,n){r.has(t)||r.set(t,[]),r.get(t).push(n)}static run(t,n){return r.has(t)||r.set(t,[]),n().then(()=>{let a=r.get(t);if(a.length>0)return e.run(t,a.shift());r.delete(t)})}static push(t,n){r.get(t)?e.enqueue(t,n):e.run(t,n)}},l=i;var g=e=>{let t=null,n=!1,a,u,s,c=new Promise((o,d)=>{s=m=>{t=t||m;let p=m-t,f=e.duration-p;if(p<=e.duration){let h=1-f/e.duration;e.advance(h),n||(a=requestAnimationFrame(s))}else e.advance(1),o()},u=()=>{n=!0,cancelAnimationFrame(a),d(new Error("animation stopped"))}}).catch(o=>o);return l.push(e.element,()=>(typeof e.beforeStart=="function"&&e.beforeStart(),requestAnimationFrame(s),new Promise(o=>{c.then(()=>o())}))),{promise:()=>c,stop:()=>u}},v=400;var x=g;export{v as a,x as b};
