<div class="fd-shellbar__action fd-shellbar__action--show-always" *ngIf="user">
    <div class="fd-user-menu">
        <ng-container *ngIf="userMenu; else justAvatar">
            <button
                fd-button
                fdType="transparent"
                class="fd-shellbar__button fd-shellbar__button--user-menu"
                [disabled]="disabled"
                [fdMenuTrigger]="userMenuComponent"
            >
                <ng-template [ngTemplateOutlet]="avatar"></ng-template>
            </button>

            <fd-menu
                #userMenuComponent
                [triggers]="triggers"
                [placement]="placement"
                [fillControlMode]="fillControlMode"
                [closeOnEscapeKey]="closeOnEscapeKey"
                [noArrow]="noArrow"
                [closeOnOutsideClick]="closeOnOutsideClick"
            >
                <li fd-menu-item *ngFor="let item of userMenu" (click)="itemClick(item, $event)">
                    <div fd-menu-interactive>
                        <span fd-menu-title>{{ item.text }}</span>
                    </div>
                </li>
            </fd-menu>
        </ng-container>
        <ng-template #justAvatar>
            <button
                fd-button
                fdType="transparent"
                class="fd-shellbar__button fd-shellbar__button--user-menu"
                [disabled]="disabled"
            >
                <ng-template [ngTemplateOutlet]="avatar"></ng-template>
            </button>
        </ng-template>
    </div>
</div>

<ng-template #avatar>
    <fd-avatar
        size="xs"
        *ngIf="!user.image"
        [colorAccent]="user.colorAccent"
        [circle]="true"
        label="{{ user.fullName }}"
    >
    </fd-avatar>

    <fd-avatar
        [colorAccent]="user.colorAccent"
        [circle]="true"
        size="xs"
        *ngIf="user.image"
        image="{{ user.image }}"
    ></fd-avatar>
</ng-template>
