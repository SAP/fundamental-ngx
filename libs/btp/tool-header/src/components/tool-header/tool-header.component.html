<div fdbToolHeaderGroup [class.fd-tool-header--menu]="showMenuButton">
    <div fdbToolHeaderElement *ngIf="fdbToolHeaderState().backButtonVisible">
        <button fd-button fdbToolHeaderButton glyph="slim-arrow-left" (click)="searchFieldExpanded.set(false)"></button>
    </div>
    <div fdbToolHeaderElement *ngIf="fdbToolHeaderState().menuButtonVisible && showMenuButton">
        <button
            fd-button
            fdbToolHeaderButton
            [title]="'btpToolHeader.menuButtonAriaLabel' | fdTranslate"
            [ariaLabel]="'btpToolHeader.menuButtonAriaLabel' | fdTranslate"
            glyph="menu2"
            (keydown.arrowLeft)="_handleMenuLeftArrowKey()"
            (keydown.arrowRight)="_handleMenuRightArrowKey()"
            (click)="menuClick.emit()"
        ></button>
    </div>
    <div fdbToolHeaderElement *ngIf="fdbToolHeaderState().logoVisible">
        <ng-container *ngIf="_toolHeaderLogoDirective; else defaultLogo">
            <ng-content select="img[fdbToolHeaderLogo]"></ng-content>
        </ng-container>
        <ng-template #defaultLogo>
            <img
                fdbToolHeaderLogo
                (click)="logoClick.emit()"
                src="https://unpkg.com/fundamental-styles/dist/images/sap-logo.png"
                srcset="
                    https://unpkg.com/fundamental-styles/dist/images/sap-logo@2x.png 1x,
                    https://unpkg.com/fundamental-styles/dist/images/sap-logo@3x.png 2x,
                    https://unpkg.com/fundamental-styles/dist/images/sap-logo@4x.png 3x
                "
                alt="SAP logo"
                aria-label="SAP logo"
                title="SAP logo"
            />
        </ng-template>
    </div>
    <ng-container *ngIf="fdbToolHeaderState().productNameVisible">
        <div fdbToolHeaderElement>
            <h1 class="fd-tool-header__product-name">
                {{ productName }}
            </h1>
        </div>
        <div fdbToolHeaderElement *ngIf="secondTitle">
            <div class="fd-tool-header__second-title">
                {{ secondTitle }}
            </div>
        </div>
    </ng-container>
</div>

<div fdbToolHeaderGroup center *ngIf="fdbToolHeaderState().searchFieldVisible">
    <ng-content select="fdb-search-field"></ng-content>
</div>

<div fdbToolHeaderGroup actions>
    <fd-overflow-layout fdbToolHeaderElement [style.justify-content]="'end'">
        <ng-container *ngIf="fdbToolHeaderState().searchFieldToggleActionVisible">
            <div fdbToolHeaderElement *fdOverflowItemRef="let hidden" [forceVisibility]="true" fdOverflowLayoutItem>
                <button
                    fd-button
                    fdbToolHeaderButton
                    glyph="search"
                    (click)="$event.stopPropagation(); expandSearchField()"
                ></button>
            </div>
        </ng-container>
        <ng-container *ngIf="fdbToolHeaderState().providedActionsVisible">
            <ng-container *ngFor="let action of _toolHeaderActionsDirective?._actions() || []">
                <div
                    fdbToolHeaderElement
                    *fdOverflowItemRef="let hidden"
                    [forceVisibility]="!!action.forceVisibility"
                    fdOverflowLayoutItem
                >
                    <button
                        fd-button
                        #buttonComponent
                        fdbToolHeaderButton
                        [glyph]="action.glyph"
                        (click)="action.clickCallback(buttonComponent)"
                        [ariaLabel]="action.label"
                    >
                        <span class="fd-button__badge" *ngIf="action.hasBadge"></span>
                    </button>
                    <div
                        class="fd-tool-header__separator"
                        *ngIf="action.hasSeparator && fdbToolHeaderState().separatorsBetweenActionsVisible"
                    ></div>
                </div>
            </ng-container>
        </ng-container>

        <ng-container *fdOverflowExpand="let overflowItems">
            <div fdbToolHeaderElement>
                <button fd-button fdbToolHeaderButton glyph="overflow" [fdMenuTrigger]="overflownItemsMenu"></button>
            </div>
            <fd-menu additionalBodyClass="fdb-tool-header-actions-overflow-popover-body" #overflownItemsMenu>
                <ng-container *ngFor="let item of overflowItems">
                    <li
                        [hasSeparator]="!!action.hasSeparator && fdbToolHeaderState().separatorsBetweenActionsVisible"
                        fd-menu-item
                        *ngIf="_actions()[item.globalIndex] as action"
                    >
                        <a
                            fd-menu-interactive
                            #menuInteractiveComponent
                            (click)="action.clickCallback(menuInteractiveComponent)"
                        >
                            <fd-menu-addon [glyph]="action.glyph"></fd-menu-addon>
                            <span fd-menu-title>
                                {{ action.label }}
                            </span>
                        </a>
                    </li>
                </ng-container>
            </fd-menu>
        </ng-container>
    </fd-overflow-layout>
    <ng-container *ngIf="fdbToolHeaderState().userAvatarVisible && _toolHeaderUser">
        <div fdbToolHeaderElement>
            <div class="fd-tool-header__separator"></div>
            <ng-content select="[fdbToolHeaderUser]"></ng-content>
        </div>
    </ng-container>
    <ng-container *ngIf="fdbToolHeaderState().productSwitchVisible && _toolHeaderProductSwitch">
        <div fdbToolHeaderElement>
            <div class="fd-tool-header__separator"></div>
            <ng-content select="fdb-tool-header-product-switch, fd-product-switch"></ng-content>
        </div>
    </ng-container>
    <div fdbToolHeaderElement *ngIf="fdbToolHeaderState().voiceInputVisible">
        <button
            fd-button
            fdbToolHeaderButton
            glyph="microphone"
            [ariaLabel]="'Search with voice'"
            (click)="microphoneClick.emit()"
        ></button>
    </div>
</div>
