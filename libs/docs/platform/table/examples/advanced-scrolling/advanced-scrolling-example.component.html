<fdp-table
    #table
    [dataSource]="source"
    [childDataSource]="childSource"
    [isTreeTable]="true"
    selectionMode="multiple"
    relationKey="children"
    emptyTableMessage="No data found"
    bodyHeight="300px"
    [virtualScroll]="true"
    [onlyRenderVisibleCells]="onlyRenderVisibleCells"
    [useCellPlaceholder]="cellPlaceholder"
    [pageScrolling]="true"
    [pageSize]="20"
    [renderAhead]="20"
    [pageScrollingThreshold]="80"
    hasChildrenKey="hasChildren"
    [expandOnInit]="true"
>
    <fdp-table-toolbar title="Order Line Items" [hideItemCount]="false" [hideSearchInput]="true">
        <fdp-table-toolbar-actions *ngIf="onlyRenderVisibleCells">
            <fdp-button label="Add column" (click)="addColumn()"></fdp-button>
            <fdp-button label="Toggle cell placeholder" (click)="toggleCellPlaceholder()"></fdp-button>
        </fdp-table-toolbar-actions>
    </fdp-table-toolbar>

    <fdp-column
        name="name"
        key="name"
        label="Name"
        align="start"
        [sortable]="true"
        [filterable]="true"
        [dataType]="dataTypeEnum.STRING"
    >
    </fdp-column>

    <fdp-column name="description" key="description" label="Description"> </fdp-column>

    <fdp-column
        name="price"
        key="price.value"
        label="Price"
        align="end"
        [sortable]="true"
        [filterable]="true"
        [dataType]="dataTypeEnum.NUMBER"
    >
    </fdp-column>

    <fdp-column
        name="status"
        key="status"
        label="Status"
        align="center"
        [sortable]="true"
        [filterable]="true"
        [dataType]="dataTypeEnum.STRING"
    >
    </fdp-column>

    <ng-container *ngIf="onlyRenderVisibleCells">
        <fdp-column
            width="100px"
            *ngFor="let column of columns; let i = index"
            [name]="column.key"
            [label]="column.label"
        >
            <fdp-table-cell *fdpCellDef="let node; let idx = rowIndex">
                Some text here {{ i + 1 }} {{ idx }}</fdp-table-cell
            >
        </fdp-column>
    </ng-container>
</fdp-table>

<!-- Connect P13 Dialog to the table -->
<fdp-table-p13-dialog [table]="table"></fdp-table-p13-dialog>
