<ng-container *ngIf="rows && rows.length; else emptyTableTemplate">
    <ng-container *ngIf="tableToolbarComponent">
        <ng-container *ngTemplateOutlet="tableToolbarComponent.contentTemplateRef; context: { counter: rows.length, size: contentDensity }"></ng-container>
    </ng-container>

    <table fd-table>
        <thead fd-table-header>
            <tr fd-table-row>
                <th fd-table-cell
                    [class.fd-table__cell--checkbox]="selectionMode === selectionModeOptions.MULTIPLE"
                    *ngIf="selectionMode === selectionModeOptions.SINGLE || selectionMode === selectionModeOptions.MULTIPLE">
                    <fd-checkbox
                        [compact]="contentDensity !== contentDensityOptions.COZY"
                        *ngIf="selectionMode === selectionModeOptions.MULTIPLE"
                        [ngModel]="checkedAll"
                        (ngModelChange)="selectAll($event)"
                        (keydown)="onKeydown($event)"
                    ></fd-checkbox>
                </th>
                <th fd-table-cell
                    [style.textAlign]="column.align"
                    *ngFor="let column of columns">
                    <ng-container *ngIf="column?.fdpHeaderCellDef?.templateRef; else defaultTableHeaderCellTemplate">
                        <ng-container *ngTemplateOutlet="column.fdpHeaderCellDef.templateRef">
                        </ng-container>
                    </ng-container>

                    <ng-template #defaultTableHeaderCellTemplate>{{ column.label }}</ng-template>
                </th>
            </tr>
        </thead>
        <tbody fd-table-body>
            <tr fd-table-row
                *ngFor="let row of rows; let i = index"
                [attr.aria-selected]="rows[i].checked">
                <td fd-table-cell
                    [class.fd-table__cell--checkbox]="selectionMode === selectionModeOptions.MULTIPLE"
                    [class.fd-table__cell--focusable]="selectionMode === selectionModeOptions.SINGLE"
                    [tabIndex]="selectionMode === selectionModeOptions.SINGLE ? 0 : -1"
                    [attr.role]="selectionMode === selectionModeOptions.SINGLE ? 'checkbox' : 'cell'"
                    *ngIf="selectionMode === selectionModeOptions.SINGLE || selectionMode === selectionModeOptions.MULTIPLE"
                    (click)="selectSingle(i, row)"
                    (keydown)="onKeydown($event)"
                >
                    <fd-checkbox
                        [compact]="contentDensity !== contentDensityOptions.COZY"
                        *ngIf="selectionMode === selectionModeOptions.MULTIPLE"
                        [ngModel]="row.checked"
                        (ngModelChange)="select(i, row, $event)"
                        (keydown)="onKeydown($event)"
                    ></fd-checkbox>
                </td>
                <td fd-table-cell
                    [style.textAlign]="column.align"
                    *ngFor="let column of columns">
                    <ng-container *ngIf="column?.fdpCellDef?.templateRef; else defaultTableCellTemplate">
                        <ng-container *ngTemplateOutlet="column.fdpCellDef.templateRef; context:{$implicit: row.value}">
                        </ng-container>
                    </ng-container>

                    <ng-template #defaultTableCellTemplate>{{ getCellValue(column.key, row) }}</ng-template>
                </td>
            </tr>
        </tbody>
    </table>
</ng-container>

<ng-template #emptyTableTemplate>
    <div>{{ emptyTableMessage }}</div>
</ng-template>
