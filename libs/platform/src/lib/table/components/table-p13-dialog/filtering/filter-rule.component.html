<div fdLayoutGridRow>
    <div fdLayoutGridCol colGrow>
        <div fdLayoutGridRow>
            <div fdLayoutGridCol colGrow>
                <!-- Column -->
                <fd-select
                    class="filter-row__select"
                    [ngModel]="rule.columnKey"
                    (ngModelChange)="rule.setColumnKey($event); _onModelChange()"
                >
                    @for (column of rule.columns; track column) {
                        <li fd-option [value]="column.key">{{ column.label }}</li>
                    }
                </fd-select>
            </div>
            <div fdLayoutGridCol colGrow>
                <!-- Strategy -->
                <fd-select
                    class="filter-row__select"
                    [ngModel]="rule.strategy"
                    (ngModelChange)="rule.setStrategy($event); _onModelChange()"
                >
                    @for (strategy of rule.strategies; track strategy) {
                        <li fd-option [value]="strategy">
                            <span>
                                {{
                                    strategyLabels[strategy] || 'platformTable.P13FilterStrategyLabelNotDefined'
                                        | fdTranslate
                                }}
                            </span>
                        </li>
                    }
                </fd-select>
            </div>
        </div>
    </div>
    <div fdLayoutGridCol colGrow>
        <div fdLayoutGridRow ngForm>
            @if (rule.strategy === FILTER_STRATEGY.BETWEEN) {
                <div fdLayoutGridCol colGrow>
                    <ng-container
                        [ngTemplateOutlet]="ruleInputTemplate"
                        [ngTemplateOutletContext]="{ valueKey: 'value' }"
                    ></ng-container>
                </div>
                <div fdLayoutGridCol colGrow>
                    <ng-container
                        [ngTemplateOutlet]="ruleInputTemplate"
                        [ngTemplateOutletContext]="{ valueKey: 'value2' }"
                    ></ng-container>
                </div>
            } @else {
                <div fdLayoutGridCol colGrow>
                    <ng-container
                        [ngTemplateOutlet]="ruleInputTemplate"
                        [ngTemplateOutletContext]="{ valueKey: 'value' }"
                    ></ng-container>
                </div>
            }
        </div>
    </div>
</div>

<!-- Rule Control Based on Data Type -->
<ng-template #ruleInputTemplate let-valueKey="valueKey">
    @switch (rule.dataType) {
        @case (DATA_TYPE.DATE) {
            <fd-date-picker
                class="filter-row__input"
                type="single"
                [required]="true"
                [name]="valueKey"
                [(ngModel)]="rule[valueKey]"
                (ngModelChange)="_onModelChange()"
            ></fd-date-picker>
        }
        @case (DATA_TYPE.BOOLEAN) {
            <fd-select
                class="filter-row__select"
                [name]="valueKey"
                [(ngModel)]="rule[valueKey]"
                (ngModelChange)="_onModelChange()"
                [required]="true"
            >
                <li fd-option [value]="undefined">
                    {{ 'platformTable.P13FilterBooleanOptionNotDefined' | fdTranslate }}
                </li>
                <li fd-option [value]="true">
                    {{ 'platformTable.P13FilterBooleanOptionTrue' | fdTranslate }}
                </li>
                <li fd-option [value]="false">
                    {{ 'platformTable.P13FilterBooleanOptionFalse' | fdTranslate }}
                </li>
            </fd-select>
        }
        @default {
            <input
                type="text"
                class="filter-row__input"
                fd-form-control
                required
                [name]="valueKey"
                [(ngModel)]="rule[valueKey]"
                (ngModelChange)="_onModelChange()"
            />
        }
    }
</ng-template>
