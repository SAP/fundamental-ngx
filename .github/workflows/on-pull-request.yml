name: PR Checks

on:
    pull_request:

env:
    NX_CLOUD_DISTRIBUTED_EXECUTION: true
    NX_CLOUD_ACCESS_TOKEN: ${{ secrets.NX_CLOUD_AUTH_TOKEN }}
concurrency:
    group: ${{ github.workflow }}-${{ github.event.number || github.ref }}
    cancel-in-progress: true
jobs:
    cloud_main:
        name: PR Build Checks
        uses: nrwl/ci/.github/workflows/nx-cloud-main.yml@v0.6
        with:
            parallel-commands-on-agents: |
                npx nx affected --target=build --base=${{ github.event.pull_request.base.ref }} --head=HEAD --parallel=3

    agents:
        name: Nx Cloud - Agents
        uses: nrwl/ci/.github/workflows/nx-cloud-agents.yml@v0.6
        with:
            number-of-agents: 3
#    build_docs:
#        name: Build Docs
#        needs: install
#        runs-on: ubuntu-latest
#        steps:
#            - uses: actions/checkout@v3
#            - uses: ./.github/actions/nodejs
#            - run: |
#                  npx nx run docs:compile-typedocs
#                  npx nx run docs:copy-docs
#                  npx nx build docs --base-href="fundamental-ngx"
